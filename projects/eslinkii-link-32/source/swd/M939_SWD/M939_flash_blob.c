#include "swd_flash_blob.h"
#include "swd_target_config.h"

static const uint32_t ES32F065x_flash_prog_blob[] = {
    0xE00ABE00, 0x062D780D, 0x24084068, 0xD3000040, 0x1E644058, 0x1C49D1FA, 0x2A001E52, 0x4770D1F2,
    0x49a548a6, 0x4aa66001, 0x60112101, 0x60422200, 0x4aa448a5, 0x4aa56002, 0x1e8960d1, 0x48a56001,
    0x600149a3, 0x600149a4, 0x220269c1, 0x61c14311, 0x47702000, 0x499e489f, 0x499f6001, 0x69c16001,
    0x43112202, 0x489861c1, 0x60014996, 0x21014a97, 0x1e8960d1, 0x20006001, 0x48934770, 0x60014991,
    0x22014992, 0x1e9160ca, 0x48926001, 0x60014990, 0x60014991, 0x29006801, 0x2111d119, 0x6a0161c1,
    0xd01407c9, 0x60812100, 0x07896a01, 0x498bd4fc, 0x6a016181, 0xd5fc0789, 0x07896a01, 0x6a01d4fc,
    0x211006ca, 0x69c22a00, 0x438adb03, 0x200161c2, 0x438a4770, 0x200061c2, 0x211f4770, 0x42880349,
    0x2000d901, 0x49784770, 0x600a4a76, 0x22014b77, 0x1e9260da, 0x4977600a, 0x600a4a75, 0x600a4a76,
    0x61ca2211, 0x60886a0a, 0x61884875, 0x07806a08, 0x6a08d5fc, 0xd4fc0780, 0x06826a08, 0x2a002010,
    0xdb0369ca, 0x61ca4382, 0x47702001, 0x61ca4382, 0xb530e7d7, 0x4c634b64, 0x4d64601c, 0x60ec2401,
    0x601c1ea4, 0x049b2301, 0xd2294298, 0x60984b61, 0xd0252900, 0x08c8074c, 0xd0002c00, 0x495c1c40,
    0x495d6019, 0x21116019, 0x6a1961d9, 0xd4fc0789, 0x21104c5b, 0x28003cff, 0x6a1dd014, 0xd4fc07ad,
    0x611d6815, 0x615d6855, 0x3208619c, 0x07ad6a1d, 0x6a1dd4fc, 0x066d1e40, 0x69d8d4ed, 0x61d84388,
    0xbd302001, 0x07806a18, 0x69d8d4fc, 0x61d84388, 0xbd302000, 0x4b44b530, 0x601c4c42, 0x24014d43,
    0x1ea460ec, 0x074b601c, 0x2b0008c9, 0x1c49d000, 0x031b2341, 0xd1044383, 0x4c424b43, 0x4c43601c,
    0x4b3c601c, 0x605c4c42, 0x605c4c42, 0x61dc2411, 0x07a46a1c, 0x6098d4fc, 0x24104d39, 0xe0143dff,
    0x07806a18, 0x6810d4fc, 0x68506118, 0x619d6158, 0x6a183208, 0xd4fc0780, 0x1e496a18, 0xd4040640,
    0x43a069d8, 0x200161d8, 0x2900bd30, 0x6a18d1e8, 0xd4fc0780, 0x43a069d8, 0x200061d8, 0xb570bd30,
    0x48214604, 0x6001491f, 0x21014a20, 0x1e8960d1, 0x20416001, 0x4e260300, 0x4b1e4d26, 0xd00643a0,
    0xd50a0360, 0xff09f7ff, 0x605d605e, 0x481ee009, 0x6001491c, 0x6001491d, 0x4815e7f6, 0x48166018,
    0x20116018, 0x6a1861d8, 0x4815609c, 0x6a186198, 0xd5fc0780, 0x07806a18, 0x6a18d4fc, 0x20100681,
    0x69d92900, 0x4381db03, 0x200161d9, 0x4381bd70, 0x200061d9, 0x0000bd70, 0x55aa6996, 0x40080000,
    0x40080400, 0x1acce551, 0x40046500, 0x40046400, 0x8ace0246, 0x40081000, 0x9bdf1357, 0x000051ae,
    0x00005ea1, 0x5a962814, 0x40080100, 0xe7cb69a5, 0x7153bfd9, 0x0642cea8, 0x00000000
};

static const program_target_t flash = {
    0x20000021, // Init
    0x20000055, // UnInit
    0x2000007b, // EraseChip
    0x200000db, // EraseSector
    0x20000133, // ProgramPage
		0x200001b5, // InfoProgramPage
    0x2000023f, // InfoErase	
	
	
    // BKPT : start of blob + 1
    // RSB  : blob start + header + rw data offset
    // RSP  : stack pointer
    {
        0x20000001,
        0x200002f8,
        0x20000500
    },

    0x20000000 + 0x00000A00,  // mem buffer location
    0x20000000,               // location to write prog_blob in target RAM
    sizeof(ES32F065x_flash_prog_blob),   // prog_blob size
    ES32F065x_flash_prog_blob,           // address of prog_blob
    0x00000400       // ram_to_flash_bytes_to_be_written
};
//target information
target_cfg_t swd_target_device={
	.flash_algo  = (program_target_t *)& flash,
};